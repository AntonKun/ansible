pipeline {
	agent any
	environment {
		ANSIBLE_PRIVATE_KEY=credentials('centos_key')
	}
	stages {
		stage('Install Ansible Requirements') {
			steps {
				sh 'ansible-galaxy collection install -r requirements.yml'
			}
		}

		stage('Start Ansible Playbook') {
			steps {
				sh 'ansible-playbook --private-key=$ANSIBLE_PRIVATE_KEY playbook-website-in-docker.yml'
			}
		}
	}
}
